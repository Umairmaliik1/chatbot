import{e as se,r as i,c as N,o as ae,f as A,w as r,j as e,l as c,z,D as H,s as h,h as n,k as B,F as X,A as O,t as l,i as le,n as q,E as oe,g as o}from"./vendor-ct0Dgaa7.js";import{u as G,b as M,a as ne}from"./index-vE_pF-Xr.js";import{_ as ie}from"./BaseLayout.vue_vue_type_script_setup_true_lang-D6k48umn.js";import{_ as w}from"./BaseCard.vue_vue_type_script_setup_true_lang-TVPlXeRZ.js";import{_ as p}from"./BaseButton.vue_vue_type_script_setup_true_lang-SXsD0NUS.js";import{_ as re}from"./BaseInput.vue_vue_type_script_setup_true_lang-D9I1de4X.js";import{_ as de}from"./StatCard.vue_vue_type_script_setup_true_lang-CLjUR74-.js";import"./utils-NIGUFBhG.js";const ce={class:"mb-8"},ue={class:"flex items-center justify-between"},me={class:"flex items-center space-x-4"},ve={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},ge={class:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8"},he={class:"card-body"},pe={class:"h-64 flex items-center justify-center"},fe={key:0,class:"text-center"},xe={key:1,class:"text-center text-gray-500"},ye={class:"card-body"},_e={class:"h-64 flex items-center justify-center"},be={key:0,class:"text-center"},we={key:1,class:"text-center text-gray-500"},ke={class:"card-header"},Ce={class:"flex items-center justify-between"},Se={class:"flex items-center space-x-4"},Le={class:"flex items-center space-x-2"},Re={class:"flex items-center space-x-2"},De={key:0,class:"p-8 text-center"},Ae={key:1,class:"p-8 text-center"},ze={key:2,class:"overflow-x-auto"},Me={class:"table"},Ve={class:"table-body"},Te={class:"table-cell"},$e={class:"table-cell"},je={class:"table-cell"},Ie={class:"table-cell"},Ne={class:"table-cell"},Be={class:"table-cell"},Xe={class:"table-cell"},Pe={class:"table-cell"},Ue={class:"table-cell"},Fe={class:"table-cell"},Ee={class:"table-cell"},He={class:"table-cell"},Oe={class:"p-6 text-center"},qe={class:"mt-6"},Ge={class:"card-header"},Ke={class:"flex items-center justify-between"},Qe={class:"flex items-center space-x-4"},We={class:"overflow-x-auto"},Ye={class:"table"},Je={class:"table-body"},Ze={key:0,class:"table-row"},et={key:1,class:"table-row"},tt={class:"table-cell"},st={class:"text-sm font-medium text-gray-900"},at={class:"text-sm text-gray-500"},lt={class:"table-cell"},ot={class:"text-sm text-gray-900"},nt={class:"text-sm text-gray-500"},it={class:"table-cell"},rt={class:"text-sm text-gray-900"},dt={class:"text-sm text-gray-500"},ct={class:"table-cell"},ut={class:"text-sm text-gray-900"},mt={class:"table-cell"},vt={class:"flex items-center"},gt={class:"text-sm text-gray-900 mr-2"},ht={class:"w-16 bg-gray-200 rounded-full h-2"},pt={class:"table-cell"},ft={key:0,class:"card-footer"},xt={class:"flex items-center justify-between"},yt={class:"text-sm text-gray-700"},_t={class:"flex items-center space-x-2"},bt={class:"text-sm text-gray-700"},wt="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z",kt="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z",Ct="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z",St="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z",k=10,jt=se({__name:"Reports",setup(Lt){const{success:C,error:g}=ne(),v=i("30"),S=i(""),V=i("all"),u=i(1),T=i(!1),L=i(!1),R=i(!1),f=i([]),D=i(!1),x=i(""),y=i(""),P=i([{key:"total_sessions",title:"Total Sessions",value:0,period:"In the last 30 days",loading:!0,icon:kt,trend:null},{key:"total_messages",title:"Messages Exchanged",value:0,period:"In the last 30 days",loading:!0,icon:wt,trend:null},{key:"avg_response_time",title:"Avg Response Time",value:0,period:"In the last 30 days",loading:!0,icon:Ct,trend:null},{key:"satisfaction_score",title:"Satisfaction Score",value:0,period:"In the last 30 days",loading:!0,icon:St,trend:null}]),$=i([{date:"2024-01-15",sessions:145,sessions_growth:12,messages:892,messages_growth:8,avg_response_time:2.3,response_time_trend:-5,satisfaction:87},{date:"2024-01-14",sessions:132,sessions_growth:-3,messages:756,messages_growth:15,avg_response_time:2.1,response_time_trend:-8,satisfaction:91},{date:"2024-01-13",sessions:128,sessions_growth:5,messages:689,messages_growth:2,avg_response_time:2.4,response_time_trend:3,satisfaction:84}]),_=N(()=>{let a=Array.isArray($.value)?$.value:[];if(S.value){const t=S.value.toLowerCase();a=a.filter(s=>s.date.includes(t)||s.sessions.toString().includes(t)||s.messages.toString().includes(t))}return V.value,a.sort((t,s)=>new Date(s.date).getTime()-new Date(t.date).getTime())}),j=N(()=>Math.ceil(_.value.length/k)),K=N(()=>{const a=(u.value-1)*k,t=a+k;return _.value.slice(a,t)}),I=async()=>{var a,t,s,m,b;if(!x.value||!y.value){g("Please select both from and to dates");return}D.value=!0;try{const d=await M.getDirect("/reports",{fromdate:x.value,todate:y.value});f.value=Array.isArray(d.reports)?d.reports:[],f.value.length===0?C("No data found for the selected date range"):C(`Loaded ${f.value.length} Xelence reports`)}catch(d){((a=d.response)==null?void 0:a.status)===400&&((m=(s=(t=d.response)==null?void 0:t.data)==null?void 0:s.detail)!=null&&m.includes("credentials"))?(g("Xelence credentials not configured","Please configure your Xelence credentials in Settings"),R.value=!1):((b=d.response)==null?void 0:b.status)===401?g("Authentication failed","Please check your Xelence credentials in Settings"):g("Failed to load Xelence reports",d.message)}finally{D.value=!1}},U=async()=>{T.value=!0,L.value=!0;try{const a=await M.get(`/reports/summary?days=${v.value}`);P.value.forEach(s=>{s.loading=!1,s.value=a[s.key]||0,s.period=`In the last ${v.value} days`});const t=await M.get(`/reports/detailed?days=${v.value}`);$.value=Array.isArray(t)?t:[]}catch(a){g("Failed to load reports",a.message)}finally{T.value=!1,L.value=!1}},Q=async()=>{try{const a=await M.get(`/reports/export?days=${v.value}`,{responseType:"blob"}),t=window.URL.createObjectURL(new Blob([a])),s=document.createElement("a");s.href=t,s.setAttribute("download",`chatbot-report-${v.value}days.xlsx`),document.body.appendChild(s),s.click(),s.remove(),window.URL.revokeObjectURL(t),C("Report exported successfully!")}catch(a){g("Failed to export report",a.message)}},W=a=>{C("Report details",`Viewing details for ${a.date}`)},Y=a=>new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),J=a=>new Date(a).toLocaleDateString("en-US",{weekday:"short"}),Z=a=>a>=80?"bg-success-500":a>=60?"bg-warning-500":"bg-error-500",ee=()=>{var t;const a=G();if((t=a.user)!=null&&t.profile){const s=!!a.user.profile.xelence_affiliateid,m=!!a.user.profile.xelence_x_api_key;R.value=s&&m}else R.value=!1},te=()=>{const a=new Date,t=new Date(a.getFullYear(),a.getMonth()-1,a.getDate());y.value=a.toISOString().split("T")[0],x.value=t.toISOString().split("T")[0]};return ae(async()=>{const a=G();a.user===null&&!a.isLoading&&await a.initializeAuth(),U(),ee(),te()}),(a,t)=>(o(),A(ie,null,{default:r(()=>[e("div",ce,[e("div",ue,[t[10]||(t[10]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900"},"Reports & Analytics"),e("p",{class:"mt-2 text-gray-600"},"Comprehensive insights into your AI chatbot performance and usage patterns.")],-1)),e("div",me,[z(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>v.value=s),onChange:U,class:"form-select w-48"},[...t[8]||(t[8]=[e("option",{value:"7"},"Last 7 Days",-1),e("option",{value:"30"},"Last 30 Days",-1),e("option",{value:"90"},"Last 90 Days",-1),e("option",{value:"365"},"Last 365 Days",-1)])],544),[[H,v.value]]),c(p,{variant:"primary",size:"sm",onClick:Q},{default:r(()=>[...t[9]||(t[9]=[e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),h(" Export Report ",-1)])]),_:1})])])]),e("div",ve,[(o(!0),n(X,null,B(P.value,s=>(o(),A(de,{key:s.key,title:s.title,value:s.value,period:s.period,loading:s.loading,icon:s.icon,trend:s.trend},null,8,["title","value","period","loading","icon","trend"]))),128))]),e("div",ge,[c(w,null,{default:r(()=>[t[13]||(t[13]=e("div",{class:"card-header"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Usage Trends"),e("p",{class:"text-sm text-gray-600 mt-1"},"Daily chat sessions and messages over time")],-1)),e("div",he,[e("div",pe,[L.value?(o(),n("div",fe,[...t[11]||(t[11]=[e("div",{class:"spinner w-8 h-8 mx-auto mb-4"},null,-1),e("p",{class:"text-sm text-gray-500"},"Loading chart data...",-1)])])):(o(),n("div",xe,[...t[12]||(t[12]=[e("svg",{class:"w-12 h-12 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})],-1),e("p",{class:"text-sm"},"Chart visualization will be implemented with Chart.js",-1)])]))])])]),_:1}),c(w,null,{default:r(()=>[t[16]||(t[16]=e("div",{class:"card-header"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Response Times"),e("p",{class:"text-sm text-gray-600 mt-1"},"Average AI response time by hour")],-1)),e("div",ye,[e("div",_e,[L.value?(o(),n("div",be,[...t[14]||(t[14]=[e("div",{class:"spinner w-8 h-8 mx-auto mb-4"},null,-1),e("p",{class:"text-sm text-gray-500"},"Loading chart data...",-1)])])):(o(),n("div",we,[...t[15]||(t[15]=[e("svg",{class:"w-12 h-12 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),e("p",{class:"text-sm"},"Response time analytics will be displayed here",-1)])]))])])]),_:1})]),R.value?(o(),A(w,{key:0,class:"mb-8"},{default:r(()=>[e("div",ke,[e("div",Ce,[t[20]||(t[20]=e("div",null,[e("h3",{class:"text-lg font-semibold text-gray-900"},"Xelence Media Reports"),e("p",{class:"text-sm text-gray-600 mt-1"},"Media performance data from Xelence API")],-1)),e("div",Se,[e("div",Le,[t[17]||(t[17]=e("label",{class:"text-sm font-medium text-gray-700"},"From:",-1)),z(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>x.value=s),type:"date",class:"form-input w-40",onChange:I},null,544),[[O,x.value]])]),e("div",Re,[t[18]||(t[18]=e("label",{class:"text-sm font-medium text-gray-700"},"To:",-1)),z(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>y.value=s),type:"date",class:"form-input w-40",onChange:I},null,544),[[O,y.value]])]),c(p,{variant:"primary",size:"sm",loading:D.value,onClick:I},{default:r(()=>[...t[19]||(t[19]=[h(" Load Reports ",-1)])]),_:1},8,["loading"])])])]),D.value?(o(),n("div",De,[...t[21]||(t[21]=[e("div",{class:"spinner w-8 h-8 mx-auto mb-4"},null,-1),e("p",{class:"text-sm text-gray-500"},"Loading Xelence reports...",-1)])])):f.value.length===0?(o(),n("div",Ae,[...t[22]||(t[22]=[e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})],-1),e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No Xelence reports found",-1),e("p",{class:"mt-1 text-sm text-gray-500"},'Select a date range and click "Load Reports" to fetch data.',-1)])])):(o(),n("div",ze,[e("table",Me,[t[23]||(t[23]=e("thead",{class:"table-header"},[e("tr",null,[e("th",{class:"table-header-cell"},"Date"),e("th",{class:"table-header-cell"},"Brand"),e("th",{class:"table-header-cell"},"Tracking Code"),e("th",{class:"table-header-cell"},"Language"),e("th",{class:"table-header-cell"},"Type"),e("th",{class:"table-header-cell"},"Size"),e("th",{class:"table-header-cell"},"Name"),e("th",{class:"table-header-cell"},"Impressions"),e("th",{class:"table-header-cell"},"Visitors"),e("th",{class:"table-header-cell"},"Registrations"),e("th",{class:"table-header-cell"},"FTD"),e("th",{class:"table-header-cell"},"Commission")])],-1)),e("tbody",Ve,[(o(!0),n(X,null,B(f.value,s=>{var m,b,d,F,E;return o(),n("tr",{key:`${s.Day}-${s.Brand}-${s.TrackingCode}`,class:"table-row"},[e("td",Te,l(s.Day||"N/A"),1),e("td",$e,l(s.Brand||"N/A"),1),e("td",je,l(s.TrackingCode||"N/A"),1),e("td",Ie,l(s.Language||"N/A"),1),e("td",Ne,l(s.Type||"N/A"),1),e("td",Be,l(s.Size||"N/A"),1),e("td",Xe,l(s.Name||"N/A"),1),e("td",Pe,l(((m=s.Impressions)==null?void 0:m.toLocaleString())||"0"),1),e("td",Ue,l(((b=s.Visitors)==null?void 0:b.toLocaleString())||"0"),1),e("td",Fe,l(((d=s.Registrations)==null?void 0:d.toLocaleString())||"0"),1),e("td",Ee,l(((F=s.FTD)==null?void 0:F.toLocaleString())||"0"),1),e("td",He,"$"+l(((E=s.Commission)==null?void 0:E.toFixed(2))||"0.00"),1)])}),128))])])]))]),_:1})):(o(),A(w,{key:1,class:"mb-8"},{default:r(()=>[e("div",Oe,[t[25]||(t[25]=e("svg",{class:"mx-auto h-12 w-12 text-warning-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})],-1)),t[26]||(t[26]=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"Xelence Integration Required",-1)),t[27]||(t[27]=e("p",{class:"mt-1 text-sm text-gray-500"},"Configure your Xelence credentials in Settings to view media reports.",-1)),e("div",qe,[c(p,{variant:"primary",onClick:t[3]||(t[3]=s=>a.$router.push("/settings"))},{default:r(()=>[...t[24]||(t[24]=[h(" Go to Settings ",-1)])]),_:1})])])]),_:1})),c(w,null,{default:r(()=>[e("div",Ge,[e("div",Ke,[t[29]||(t[29]=e("div",null,[e("h3",{class:"text-lg font-semibold text-gray-900"},"Chatbot Performance Reports"),e("p",{class:"text-sm text-gray-600 mt-1"},"Comprehensive breakdown of chatbot performance metrics")],-1)),e("div",Qe,[c(re,{modelValue:S.value,"onUpdate:modelValue":t[4]||(t[4]=s=>S.value=s),placeholder:"Search reports...",size:"sm",class:"w-64"},null,8,["modelValue"]),z(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>V.value=s),class:"form-select w-40"},[...t[28]||(t[28]=[e("option",{value:"all"},"All Metrics",-1),e("option",{value:"sessions"},"Sessions",-1),e("option",{value:"messages"},"Messages",-1),e("option",{value:"response_time"},"Response Time",-1),e("option",{value:"satisfaction"},"Satisfaction",-1)])],512),[[H,V.value]])])])]),e("div",We,[e("table",Ye,[t[33]||(t[33]=e("thead",{class:"table-header"},[e("tr",null,[e("th",{class:"table-header-cell"},"Date"),e("th",{class:"table-header-cell"},"Sessions"),e("th",{class:"table-header-cell"},"Messages"),e("th",{class:"table-header-cell"},"Avg Response Time"),e("th",{class:"table-header-cell"},"Satisfaction"),e("th",{class:"table-header-cell"},"Actions")])],-1)),e("tbody",Je,[T.value?(o(),n("tr",Ze,[...t[30]||(t[30]=[e("td",{colspan:"6",class:"table-cell text-center py-8"},[e("div",{class:"flex items-center justify-center space-x-2"},[e("div",{class:"spinner w-5 h-5"}),e("span",{class:"text-sm text-gray-500"},"Loading reports...")])],-1)])])):_.value.length===0?(o(),n("tr",et,[...t[31]||(t[31]=[e("td",{colspan:"6",class:"table-cell text-center py-8"},[e("div",{class:"text-center"},[e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})]),e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No reports found"),e("p",{class:"mt-1 text-sm text-gray-500"},"Try adjusting your search or date range.")])],-1)])])):(o(!0),n(X,{key:2},B(K.value,s=>(o(),n("tr",{key:s.date,class:"table-row"},[e("td",tt,[e("div",st,l(Y(s.date)),1),e("div",at,l(J(s.date)),1)]),e("td",lt,[e("div",ot,l(s.sessions.toLocaleString()),1),e("div",nt,l(s.sessions_growth)+"% vs prev",1)]),e("td",it,[e("div",rt,l(s.messages.toLocaleString()),1),e("div",dt,l(s.messages_growth)+"% vs prev",1)]),e("td",ct,[e("div",ut,l(s.avg_response_time)+"s",1),e("div",{class:q(["text-sm",s.response_time_trend>0?"text-error-500":"text-success-500"])},l(s.response_time_trend>0?"+":"")+l(s.response_time_trend)+"% vs prev ",3)]),e("td",mt,[e("div",vt,[e("div",gt,l(s.satisfaction)+"%",1),e("div",ht,[e("div",{class:q(["h-2 rounded-full",Z(s.satisfaction)]),style:oe({width:s.satisfaction+"%"})},null,6)])])]),e("td",pt,[c(p,{variant:"ghost",size:"sm",onClick:m=>W(s)},{default:r(()=>[...t[32]||(t[32]=[h(" View Details ",-1)])]),_:2},1032,["onClick"])])]))),128))])])]),j.value>1?(o(),n("div",ft,[e("div",xt,[e("div",yt," Showing "+l((u.value-1)*k+1)+" to "+l(Math.min(u.value*k,_.value.length))+" of "+l(_.value.length)+" results ",1),e("div",_t,[c(p,{variant:"secondary",size:"sm",disabled:u.value===1,onClick:t[6]||(t[6]=s=>u.value--)},{default:r(()=>[...t[34]||(t[34]=[h(" Previous ",-1)])]),_:1},8,["disabled"]),e("span",bt," Page "+l(u.value)+" of "+l(j.value),1),c(p,{variant:"secondary",size:"sm",disabled:u.value===j.value,onClick:t[7]||(t[7]=s=>u.value++)},{default:r(()=>[...t[35]||(t[35]=[h(" Next ",-1)])]),_:1},8,["disabled"])])])])):le("",!0)]),_:1})]),_:1}))}});export{jt as default};
