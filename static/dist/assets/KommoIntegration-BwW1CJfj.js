import{b as v,a as M}from"./index-vE_pF-Xr.js";import{_ as B}from"./BaseLayout.vue_vue_type_script_setup_true_lang-D6k48umn.js";import{_ as x}from"./BaseCard.vue_vue_type_script_setup_true_lang-TVPlXeRZ.js";import{_ as h}from"./BaseButton.vue_vue_type_script_setup_true_lang-SXsD0NUS.js";import{_ as I}from"./BaseInput.vue_vue_type_script_setup_true_lang-D9I1de4X.js";import{e as T,r as d,c as F,o as W,f as z,w as l,j as t,l as a,n as g,t as u,s as b,h as E,k as $,F as N,g as K}from"./vendor-ct0Dgaa7.js";import"./utils-NIGUFBhG.js";const R={class:"mb-8"},Y={class:"flex items-center justify-between"},L={class:"flex items-center space-x-4"},q={class:"flex items-center space-x-2"},G={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},U={class:"space-y-6"},D={class:"flex items-center justify-between p-4 bg-gray-50 rounded-lg"},H={class:"flex items-center space-x-2"},J={class:"space-y-4"},O={class:"flex items-center justify-between p-4 bg-gray-50 rounded-lg"},Q={class:"flex justify-end space-x-4"},X={class:"space-y-6"},Z={class:"space-y-3"},tt={class:"relative"},et=["value"],st={class:"space-y-6"},ot={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},at={class:"w-12 h-12 bg-primary-100 rounded-full flex items-center justify-center mx-auto mb-4"},nt={class:"text-lg font-semibold text-primary-600"},it={class:"text-sm font-medium text-gray-900 mb-2"},rt={class:"text-xs text-gray-500"},yt=T({__name:"KommoIntegration",setup(lt){const{success:p,error:m}=M(),n=d(""),i=d(""),r=d(!1),f=d(!1),y=d(!1),o=d({apiKey:"",subdomain:""}),j=[{title:"Get API Key",description:"Log into your Kommo account and generate an API key from the integrations section."},{title:"Enter Credentials",description:"Enter your API key and subdomain in the configuration form above."},{title:"Test Connection",description:'Click "Test Connection" to verify your credentials are working correctly.'},{title:"Install Widget",description:"Copy the widget code and add it to your website to start using the chatbot."}],w=F(()=>`<!-- AI Chatbot Widget -->
<script>
  (function() {
    var script = document.createElement('script');
    script.src = '${window.location.origin}/static/chatbot.js';
    script.async = true;
    document.head.appendChild(script);
  })();
<\/script>`),C=()=>(o.value={apiKey:"",subdomain:""},n.value.trim()||(o.value.apiKey="API key is required"),i.value.trim()||(o.value.subdomain="Subdomain is required"),!o.value.apiKey&&!o.value.subdomain),A=async()=>{if(C()){f.value=!0;try{const s=await v.post("/kommo/test-connection",{api_key:n.value,subdomain:i.value});s.success?p("Connection successful!","Your Kommo credentials are working correctly."):m("Connection failed",s.message||"Invalid credentials")}catch(s){m("Connection test failed",s.message)}finally{f.value=!1}}},S=async()=>{if(C()){y.value=!0;try{await v.post("/kommo/configure",{api_key:n.value,subdomain:i.value}),p("Configuration saved!","Your Kommo integration has been configured successfully."),await k()}catch(s){m("Failed to save configuration",s.message)}finally{y.value=!1}}},P=()=>{n.value="",i.value="",o.value={apiKey:"",subdomain:""}},V=async()=>{try{await navigator.clipboard.writeText(w.value),p("Widget code copied!","Paste it into your website to install the chatbot.")}catch{m("Failed to copy code","Please copy the code manually.")}},k=async()=>{try{const s=await v.get("/kommo/status");r.value=s.active||!1,s.config&&(n.value=s.config.api_key||"",i.value=s.config.subdomain||"")}catch(s){console.error("Failed to load integration status:",s)}};return W(()=>{k()}),(s,e)=>(K(),z(B,null,{default:l(()=>[t("div",R,[t("div",Y,[e[2]||(e[2]=t("div",null,[t("h1",{class:"text-3xl font-bold text-gray-900"},"Kommo Integration"),t("p",{class:"mt-2 text-gray-600"},"Connect your AI chatbot with Kommo CRM for seamless customer management.")],-1)),t("div",L,[t("div",q,[t("div",{class:g(["w-3 h-3 rounded-full",r.value?"bg-success-400":"bg-warning-400"])},null,2),t("span",{class:g(["text-sm font-medium",r.value?"text-success-600":"text-warning-600"])},u(r.value?"Connected":"Not Connected"),3)])])])]),t("div",G,[a(x,{class:"lg:col-span-2"},{default:l(()=>[e[9]||(e[9]=t("div",{class:"card-header"},[t("h3",{class:"text-lg font-semibold text-gray-900"},"Integration Status"),t("p",{class:"text-sm text-gray-600 mt-1"},"Current connection status and configuration")],-1)),t("div",U,[t("div",D,[e[3]||(e[3]=t("div",{class:"flex items-center space-x-3"},[t("div",{class:"w-10 h-10 bg-primary-100 rounded-lg flex items-center justify-center"},[t("svg",{class:"w-5 h-5 text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})])]),t("div",null,[t("h4",{class:"text-sm font-medium text-gray-900"},"Kommo CRM Connection"),t("p",{class:"text-sm text-gray-500"},"API integration status")])],-1)),t("div",H,[t("div",{class:g(["w-3 h-3 rounded-full",r.value?"bg-success-400":"bg-warning-400"])},null,2),t("span",{class:g(["text-sm font-medium",r.value?"text-success-600":"text-warning-600"])},u(r.value?"Active":"Inactive"),3)])]),t("div",J,[e[4]||(e[4]=t("h4",{class:"text-sm font-medium text-gray-900"},"API Configuration",-1)),a(I,{modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=c=>n.value=c),type:"password",label:"Kommo API Key",placeholder:"Enter your Kommo API key",error:o.value.apiKey,hint:"You can find your API key in Kommo settings under Integrations"},null,8,["modelValue","error"]),a(I,{modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=c=>i.value=c),type:"text",label:"Kommo Subdomain",placeholder:"your-company",error:o.value.subdomain,hint:"Your Kommo subdomain (without .kommo.com)"},null,8,["modelValue","error"])]),t("div",O,[e[6]||(e[6]=t("div",null,[t("h4",{class:"text-sm font-medium text-gray-900"},"Test Connection"),t("p",{class:"text-sm text-gray-500"},"Verify your API credentials")],-1)),a(h,{variant:"secondary",size:"sm",loading:f.value,onClick:A},{default:l(()=>[...e[5]||(e[5]=[b(" Test Connection ",-1)])]),_:1},8,["loading"])]),t("div",Q,[a(h,{variant:"secondary",onClick:P},{default:l(()=>[...e[7]||(e[7]=[b(" Reset ",-1)])]),_:1}),a(h,{variant:"primary",loading:y.value,onClick:S},{default:l(()=>[...e[8]||(e[8]=[b(" Save Configuration ",-1)])]),_:1},8,["loading"])])])]),_:1}),a(x,null,{default:l(()=>[e[15]||(e[15]=t("div",{class:"card-header"},[t("h3",{class:"text-lg font-semibold text-gray-900"},"Widget Setup"),t("p",{class:"text-sm text-gray-600 mt-1"},"Configure the chat widget for your website")],-1)),t("div",X,[e[13]||(e[13]=t("div",{class:"flex items-center justify-between p-4 bg-gray-50 rounded-lg"},[t("div",{class:"flex items-center space-x-3"},[t("div",{class:"w-10 h-10 bg-success-100 rounded-lg flex items-center justify-center"},[t("svg",{class:"w-5 h-5 text-success-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])]),t("div",null,[t("h4",{class:"text-sm font-medium text-gray-900"},"Widget Status"),t("p",{class:"text-sm text-gray-500"},"Installation status")])]),t("span",{class:"text-sm font-medium text-success-600"},"Ready")],-1)),t("div",Z,[e[11]||(e[11]=t("h4",{class:"text-sm font-medium text-gray-900"},"Installation Code",-1)),t("div",tt,[t("textarea",{value:w.value,readonly:"",class:"form-textarea text-xs font-mono bg-gray-50 resize-none",rows:"8"},null,8,et),t("button",{onClick:V,class:"absolute top-2 right-2 p-2 text-gray-400 hover:text-gray-600 transition-colors"},[...e[10]||(e[10]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)])])]),e[12]||(e[12]=t("p",{class:"text-xs text-gray-500"}," Copy this code and paste it before the closing </body> tag on your website. ",-1))]),e[14]||(e[14]=t("div",{class:"space-y-3"},[t("h4",{class:"text-sm font-medium text-gray-900"},"Widget Preview"),t("div",{class:"border border-gray-200 rounded-lg p-4 bg-gray-50"},[t("div",{class:"flex items-center space-x-3"},[t("div",{class:"w-8 h-8 bg-primary-600 rounded-full flex items-center justify-center"},[t("svg",{class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})])]),t("div",null,[t("p",{class:"text-sm font-medium text-gray-900"},"AI Assistant"),t("p",{class:"text-xs text-gray-500"},"Click to start chatting")])])])],-1))])]),_:1})]),a(x,{class:"mt-8"},{default:l(()=>[e[16]||(e[16]=t("div",{class:"card-header"},[t("h3",{class:"text-lg font-semibold text-gray-900"},"Integration Guide"),t("p",{class:"text-sm text-gray-600 mt-1"},"Step-by-step instructions for setting up Kommo integration")],-1)),t("div",st,[t("div",ot,[(K(),E(N,null,$(j,(c,_)=>t("div",{key:_,class:"text-center"},[t("div",at,[t("span",nt,u(_+1),1)]),t("h4",it,u(c.title),1),t("p",rt,u(c.description),1)])),64))])])]),_:1})]),_:1}))}});export{yt as default};
