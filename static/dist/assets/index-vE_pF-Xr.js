const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/HomePage-D2NYi_Ik.js","assets/vendor-ct0Dgaa7.js","assets/Login-BFgl7Am8.js","assets/utils-NIGUFBhG.js","assets/Signup-z-OuU1k0.js","assets/ForgotPassword-B8bLVvQl.js","assets/BaseCard.vue_vue_type_script_setup_true_lang-TVPlXeRZ.js","assets/BaseButton.vue_vue_type_script_setup_true_lang-SXsD0NUS.js","assets/BaseInput.vue_vue_type_script_setup_true_lang-D9I1de4X.js","assets/Dashboard-D5Tfmjgd.js","assets/BaseLayout.vue_vue_type_script_setup_true_lang-D6k48umn.js","assets/StatCard.vue_vue_type_script_setup_true_lang-CLjUR74-.js","assets/ChatHistory-B8CSWnMQ.js","assets/Analytics-CmNpEPSA.js","assets/Reports-BxmrlwQ6.js","assets/Instructions-COJZKMBg.js","assets/TestChat-DHO0MI06.js","assets/KommoIntegration-BwW1CJfj.js","assets/Settings-DDSUkp9l.js"])))=>i.map(i=>d[i]);
import{d as q,r as g,c as b,a as V,b as j,e as P,o as D,f as S,g as f,T as z,w as U,h as w,i as L,n as T,j as m,t as k,F as $,k as N,u as x,l as R,m as B,p as M,q as G}from"./vendor-ct0Dgaa7.js";import{a as v}from"./utils-NIGUFBhG.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function e(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(s){if(s.ep)return;s.ep=!0;const a=e(s);fetch(s.href,a)}})();const F="modulepreload",W=function(u){return"/"+u},O={},d=function(t,e,o){let s=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),i=(r==null?void 0:r.nonce)||(r==null?void 0:r.getAttribute("nonce"));s=Promise.allSettled(e.map(c=>{if(c=W(c),c in O)return;O[c]=!0;const p=c.endsWith(".css"),l=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${l}`))return;const n=document.createElement("link");if(n.rel=p?"stylesheet":F,p||(n.as="script"),n.crossOrigin="",n.href=c,i&&n.setAttribute("nonce",i),document.head.appendChild(n),p)return new Promise((h,y)=>{n.addEventListener("load",h),n.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(r){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=r,window.dispatchEvent(i),!i.defaultPrevented)throw r}return s.then(r=>{for(const i of r||[])i.status==="rejected"&&a(i.reason);return t().catch(a)})};class H{constructor(){this.api=v.create({baseURL:"/api",timeout:3e4,withCredentials:!0,headers:{"Content-Type":"application/json"}}),this.authApi=v.create({baseURL:"",timeout:3e4,withCredentials:!0,headers:{"Content-Type":"application/json"}}),this.dashboardApi=v.create({baseURL:"",timeout:3e4,withCredentials:!0,headers:{"Content-Type":"application/json"}}),this.kommoApi=v.create({baseURL:"/api/kommo",timeout:3e4,withCredentials:!0,headers:{"Content-Type":"application/json"}}),this.setupInterceptors()}setupInterceptors(){[this.api,this.authApi,this.dashboardApi,this.kommoApi].forEach(t=>{t.interceptors.request.use(e=>e,e=>Promise.reject(e)),t.interceptors.response.use(e=>e.data,e=>{var s,a,r;if(((s=e.response)==null?void 0:s.status)===401&&window.location.pathname!=="/login"){const i=E();i.user=null,window.location.href="/login"}const o=((r=(a=e.response)==null?void 0:a.data)==null?void 0:r.detail)||e.message||"An error occurred";return Promise.reject(new Error(o))})})}async get(t,e){return await this.api.get(t,{params:e})}async getDirect(t,e){return(await this.api.get(t,{params:e})).data}async post(t,e,o){return await this.api.post(t,e,o)}async put(t,e){return await this.api.put(t,e)}async delete(t){return await this.api.delete(t)}async authGet(t,e){return await this.authApi.get(t,{params:e})}async authPost(t,e,o){return await this.authApi.post(t,e,o)}async authPut(t,e){return await this.authApi.put(t,e)}async authDelete(t){return await this.authApi.delete(t)}async dashboardGet(t,e){return await this.dashboardApi.get(t,{params:e})}async dashboardPost(t,e,o){return await this.dashboardApi.post(t,e,o)}async dashboardPut(t,e){return await this.dashboardApi.put(t,e)}async dashboardDelete(t){return await this.dashboardApi.delete(t)}async kommoGet(t,e){return await this.kommoApi.get(t,{params:e})}async kommoPost(t,e,o){return await this.kommoApi.post(t,e,o)}async kommoPut(t,e){return await this.kommoApi.put(t,e)}async kommoDelete(t){return await this.kommoApi.delete(t)}async upload(t,e,o){return await this.api.post(t,e,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:a=>{if(o&&a.total){const r=Math.round(a.loaded*100/a.total);o(r)}}})}async stream(t,e,o){var c;const s=await fetch(`/api${t}`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const a=(c=s.body)==null?void 0:c.getReader();if(!a)throw new Error("No response body");const r=new TextDecoder;let i="";try{for(;;){const{value:p,done:l}=await a.read();if(l)break;i+=r.decode(p,{stream:!0});const n=i.split(`
`);i=n.pop()||"";for(const h of n)if(h.startsWith("data: "))try{const y=JSON.parse(h.substring(6));y.content&&y.content!=="[DONE]"&&o(y.content)}catch{}}}finally{a.releaseLock()}}}const _=new H,E=q("auth",()=>{const u=g(null),t=g(!1),e=g(null),o=b(()=>!!u.value);return{user:u,isLoading:t,error:e,isAuthenticated:o,login:async l=>{t.value=!0,e.value=null;try{const n=new URLSearchParams;n.append("username",l.username),n.append("password",l.password),l.remember_me&&n.append("remember_me","true");const h=await _.authPost("/api/login",n,{headers:{"Content-Type":"application/x-www-form-urlencoded"}});return h.user&&(u.value=h.user),h}catch(n){throw e.value=n.message||"Login failed",n}finally{t.value=!1}},signup:async l=>{t.value=!0,e.value=null;try{const n=new URLSearchParams;return n.append("username",l.username),n.append("password",l.password),n.append("confirm_password",l.confirm_password),await _.authPost("/api/signup",n,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})}catch(n){throw e.value=n.message||"Signup failed",n}finally{t.value=!1}},logout:async()=>{t.value=!0;try{await _.authGet("/logout")}catch(l){console.error("Logout error:",l)}finally{u.value=null,t.value=!1}},initializeAuth:async()=>{try{const l=await _.authGet("/auth/me");u.value=l.user}catch{u.value=null}},updateProfile:async l=>{t.value=!0,e.value=null;try{const n=await _.dashboardPost("/dashboard/update-profile",l);return u.value=n.user,n}catch(n){throw e.value=n.message||"Profile update failed",n}finally{t.value=!1}},changePassword:async l=>{t.value=!0,e.value=null;try{return await _.dashboardPost("/dashboard/update-password",l)}catch(n){throw e.value=n.message||"Password change failed",n}finally{t.value=!1}}}}),I=V({history:j(),routes:[{path:"/",name:"home",component:()=>d(()=>import("./HomePage-D2NYi_Ik.js"),__vite__mapDeps([0,1])),meta:{requiresAuth:!1}},{path:"/login",name:"login",component:()=>d(()=>import("./Login-BFgl7Am8.js"),__vite__mapDeps([2,1,3])),meta:{requiresAuth:!1}},{path:"/signup",name:"signup",component:()=>d(()=>import("./Signup-z-OuU1k0.js"),__vite__mapDeps([4,1,3])),meta:{requiresAuth:!1}},{path:"/forgot-password",name:"forgot-password",component:()=>d(()=>import("./ForgotPassword-B8bLVvQl.js"),__vite__mapDeps([5,1,6,7,8,3])),meta:{requiresAuth:!1}},{path:"/dashboard",name:"dashboard",component:()=>d(()=>import("./Dashboard-D5Tfmjgd.js"),__vite__mapDeps([9,1,10,6,7,11,3])),meta:{requiresAuth:!0}},{path:"/chat-history",name:"chat-history",component:()=>d(()=>import("./ChatHistory-B8CSWnMQ.js"),__vite__mapDeps([12,1,10,6,7,3])),meta:{requiresAuth:!0}},{path:"/analytics",name:"analytics",component:()=>d(()=>import("./Analytics-CmNpEPSA.js"),__vite__mapDeps([13,1,10,6,8,11,3])),meta:{requiresAuth:!0}},{path:"/reports",name:"reports",component:()=>d(()=>import("./Reports-BxmrlwQ6.js"),__vite__mapDeps([14,1,10,6,7,8,11,3])),meta:{requiresAuth:!0}},{path:"/instructions",name:"instructions",component:()=>d(()=>import("./Instructions-COJZKMBg.js"),__vite__mapDeps([15,1,10,6,7,8,3])),meta:{requiresAuth:!0}},{path:"/test-chat",name:"test-chat",component:()=>d(()=>import("./TestChat-DHO0MI06.js"),__vite__mapDeps([16,1,10,6,7,8,3])),meta:{requiresAuth:!0}},{path:"/kommo",name:"kommo",component:()=>d(()=>import("./KommoIntegration-BwW1CJfj.js"),__vite__mapDeps([17,10,1,6,7,8,3])),meta:{requiresAuth:!0}},{path:"/settings",name:"settings",component:()=>d(()=>import("./Settings-DDSUkp9l.js"),__vite__mapDeps([18,1,10,6,7,8,3])),meta:{requiresAuth:!0}}]});I.beforeEach((u,t,e)=>{const o=E();u.meta.requiresAuth&&!o.isAuthenticated?e("/login"):(u.name==="login"||u.name==="signup")&&o.isAuthenticated?e("/dashboard"):e()});const A=g([]);function J(){const u=r=>{const i=Math.random().toString(36).substr(2,9),c={id:i,type:"info",duration:5e3,...r};return A.value.push(c),i};return{toasts:A,addToast:u,removeToast:r=>{const i=A.value.findIndex(c=>c.id===r);i>-1&&A.value.splice(i,1)},success:(r,i,c)=>u({type:"success",title:r,message:i,duration:c}),error:(r,i,c)=>u({type:"error",title:r,message:i,duration:c}),warning:(r,i,c)=>u({type:"warning",title:r,message:i,duration:c}),info:(r,i,c)=>u({type:"info",title:r,message:i,duration:c})}}const K={class:"flex items-start"},X={class:"flex-shrink-0"},Q=["d"],Y={class:"ml-3 w-0 flex-1"},Z={class:"text-sm font-medium text-gray-900"},ee={key:0,class:"mt-1 text-sm text-gray-500"},te="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",se="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z",re="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z",oe="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z",ne=P({__name:"Toast",props:{type:{default:"info"},title:{},message:{},duration:{default:5e3}},emits:["close"],setup(u,{emit:t}){const e=u,o=t,s=g(!1),a=b(()=>({success:"toast-success",error:"toast-error",warning:"toast-warning",info:"toast-info"})[e.type]),r=b(()=>({success:te,error:oe,warning:se,info:re})[e.type]),i=b(()=>({success:"text-success-400",error:"text-error-400",warning:"text-warning-400",info:"text-primary-400"})[e.type]),c=()=>{s.value=!1,setTimeout(()=>{o("close")},300)};return D(()=>{s.value=!0,e.duration>0&&setTimeout(()=>{c()},e.duration)}),(p,l)=>(f(),S(z,{"enter-active-class":"transform ease-out duration-300 transition","enter-from-class":"translate-y-2 opacity-0 sm:translate-y-0 sm:translate-x-2","enter-to-class":"translate-y-0 opacity-100 sm:translate-x-0","leave-active-class":"transition ease-in duration-100","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:U(()=>[s.value?(f(),w("div",{key:0,class:T(["toast",a.value])},[m("div",K,[m("div",X,[(f(),w("svg",{class:T(["h-5 w-5",i.value]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[m("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:r.value},null,8,Q)],2))]),m("div",Y,[m("p",Z,k(p.title),1),p.message?(f(),w("p",ee,k(p.message),1)):L("",!0)]),m("div",{class:"ml-4 flex-shrink-0 flex"},[m("button",{onClick:c,class:"bg-white rounded-md inline-flex text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},[...l[0]||(l[0]=[m("span",{class:"sr-only"},"Close",-1),m("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[m("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)])])])])],2)):L("",!0)]),_:1}))}}),ae={class:"fixed top-4 right-4 z-50 space-y-2"},ie=P({__name:"ToastContainer",setup(u){const{toasts:t,removeToast:e}=J();return(o,s)=>(f(),w("div",ae,[(f(!0),w($,null,N(x(t),a=>(f(),S(ne,{key:a.id,type:a.type,title:a.title,message:a.message,duration:a.duration,onClose:r=>x(e)(a.id)},null,8,["type","title","message","duration","onClose"]))),128))]))}}),ce={id:"app",class:"min-h-screen bg-gray-50"},ue=P({__name:"App",setup(u){const t=E();return D(()=>{t.initializeAuth()}),(e,o)=>{const s=B("RouterView");return f(),w("div",ce,[R(s),R(ie)])}}}),C=M(ue);C.use(G());C.use(I);C.mount("#app");export{J as a,_ as b,E as u};
