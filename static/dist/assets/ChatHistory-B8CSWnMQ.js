import{e as V,r as m,o as z,f as k,w as h,j as e,i as N,s as C,l as g,t as r,h as i,F as M,k as b,n as p,y as H,g as a}from"./vendor-ct0Dgaa7.js";import{b as f,a as E}from"./index-vE_pF-Xr.js";import{_ as q}from"./BaseLayout.vue_vue_type_script_setup_true_lang-D6k48umn.js";import{_ as S}from"./BaseCard.vue_vue_type_script_setup_true_lang-TVPlXeRZ.js";import{_ as $}from"./BaseButton.vue_vue_type_script_setup_true_lang-SXsD0NUS.js";import"./utils-NIGUFBhG.js";const G={class:"mb-8"},J={class:"flex items-center justify-between"},K={class:"grid grid-cols-1 lg:grid-cols-3 gap-8 h-[calc(100vh-200px)]"},O={class:"card-header"},P={class:"text-sm text-gray-600 mt-1"},Q={class:"flex-1 overflow-y-auto"},R={key:0,class:"text-center py-12"},U={key:1,class:"space-y-2 p-4"},W=["onClick"],X={class:"flex-1 min-w-0"},Y={class:"text-sm font-medium text-gray-900 truncate"},Z={class:"text-xs text-gray-500"},I=["onClick"],ee={key:0,class:"flex-1 flex items-center justify-center"},te={key:1,class:"flex flex-col h-full"},se={class:"card-header"},oe={class:"flex items-center justify-between"},ae={class:"text-lg font-semibold text-gray-900"},le={class:"text-sm text-gray-600"},ne={class:"flex-1 overflow-y-auto p-6 space-y-4"},re={class:"whitespace-pre-wrap"},ie={class:"text-xs mt-2 opacity-70"},ye=V({__name:"ChatHistory",setup(ce){const{success:_,error:v}=E(),l=m([]),n=m(null),d=m([]);m(!1);const y=m(!1),j=async()=>{try{const s=await f.get("/sessions");l.value=s}catch(s){v("Failed to load sessions",s.message)}},A=async s=>{n.value=s,await B(s.id)},B=async s=>{try{const t=await f.get(`/sessions/${s}`);d.value=t}catch(t){v("Failed to load messages",t.message)}},L=async s=>{var t;if(confirm("Are you sure you want to delete this chat session?"))try{await f.delete(`/sessions/${s}`),l.value=l.value.filter(o=>o.id!==s),((t=n.value)==null?void 0:t.id)===s&&(n.value=null,d.value=[]),_("Session deleted successfully")}catch(o){v("Failed to delete session",o.message)}},T=async()=>{if(confirm("Are you sure you want to delete ALL chat sessions? This action cannot be undone.")){y.value=!0;try{await f.delete("/sessions/all"),l.value=[],n.value=null,d.value=[],_("All sessions deleted successfully")}catch(s){v("Failed to delete all sessions",s.message)}finally{y.value=!1}}},w=s=>{const t=new Date(s),c=Math.round((new Date().getTime()-t.getTime())/1e3),u=Math.round(c/60),x=Math.round(u/60),F=Math.round(x/24);return c<60?`${c} sec ago`:u<60?`${u} min ago`:x<24?`${x} hr ago`:`${F} days ago`},D=s=>new Date(s).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return z(()=>{j()}),(s,t)=>(a(),k(q,null,{default:h(()=>[e("div",G,[e("div",J,[t[2]||(t[2]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900"},"Chat History"),e("p",{class:"mt-2 text-gray-600"},"View and manage your conversation history with the AI assistant.")],-1)),l.value.length>0?(a(),k($,{key:0,variant:"error",size:"sm",onClick:T,loading:y.value},{default:h(()=>[...t[1]||(t[1]=[e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),C(" Delete All ",-1)])]),_:1},8,["loading"])):N("",!0)])]),e("div",K,[g(S,{class:"lg:col-span-1 flex flex-col"},{default:h(()=>[e("div",O,[t[3]||(t[3]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Chat Sessions",-1)),e("p",P,r(l.value.length)+" total sessions",1)]),e("div",Q,[l.value.length===0?(a(),i("div",R,[...t[4]||(t[4]=[e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})],-1),e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No chat sessions",-1),e("p",{class:"mt-1 text-sm text-gray-500"},"Start a conversation to see it here.",-1)])])):(a(),i("div",U,[(a(!0),i(M,null,b(l.value,o=>{var c;return a(),i("div",{key:o.id,class:p(["flex items-center justify-between p-3 rounded-lg cursor-pointer transition-colors",((c=n.value)==null?void 0:c.id)===o.id?"bg-primary-50 border border-primary-200":"hover:bg-gray-50 border border-transparent"]),onClick:u=>A(o)},[e("div",X,[e("p",Y,r(o.title),1),e("p",Z,r(w(o.updated_at)),1)]),e("button",{onClick:H(u=>L(o.id),["stop"]),class:"ml-2 p-1 text-gray-400 hover:text-error-600 transition-colors"},[...t[5]||(t[5]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,I)],10,W)}),128))]))])]),_:1}),g(S,{class:"lg:col-span-2 flex flex-col"},{default:h(()=>[n.value?(a(),i("div",te,[e("div",se,[e("div",oe,[e("div",null,[e("h3",ae,r(n.value.title),1),e("p",le,r(d.value.length)+" messages â€¢ "+r(w(n.value.updated_at)),1)]),g($,{variant:"primary",size:"sm",onClick:t[0]||(t[0]=o=>s.$router.push("/test-chat"))},{default:h(()=>[...t[7]||(t[7]=[C(" Continue Chat ",-1)])]),_:1})])]),e("div",ne,[(a(!0),i(M,null,b(d.value,o=>(a(),i("div",{key:o.id,class:p(["flex",o.role==="user"?"justify-end":"justify-start"])},[e("div",{class:p(["max-w-xs lg:max-w-md px-4 py-3 rounded-2xl",o.role==="user"?"bg-primary-600 text-white":"bg-gray-100 text-gray-900"])},[e("div",re,r(o.content),1),e("div",ie,r(D(o.timestamp)),1)],2)],2))),128))])])):(a(),i("div",ee,[...t[6]||(t[6]=[e("div",{class:"text-center"},[e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})]),e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"Select a session"),e("p",{class:"mt-1 text-sm text-gray-500"},"Choose a chat session to view the conversation.")],-1)])]))]),_:1})])]),_:1}))}});export{ye as default};
